@startuml
left to right direction

class LoginUI {
    + LoginUI(credentialHandler, role)
    - doShow()
    - headline()
}

class AuthenticationCredentialHandler {
    + authenticated(username, password, role)
}

class AuthzRegistry {
    + configure(userRepo, policy, encoder)
    + userService()
    + authenticationService()
    + authorizationService()
}

class AuthorizationService {
    + authenticate(username, rawPassword, roles)
    + changePassword(user, oldPassword, newPassword)
    + changePassword(oldPassword, newPassword)
    + resetPassword(user)
    + confirmResetPassword(user, token, newPass)
    - noActionRightsToValidate(role)
    - retrieveUser(username)
}

interface Authenticator {
    + authenticate(username, password, role)
}

interface UserRepository {
    + findByActive(active)
}

LoginUI --> AuthenticationCredentialHandler
AuthenticationCredentialHandler -> AuthzRegistry
AuthzRegistry -> AuthorizationService
AuthorizationService -> UserRepository
AuthorizationService --> Authenticator : implements

@enduml